import React, { useState, useEffect } from 'react';
import { ArrowLeft, Plus, Trash2, Send, BarChart3, Users, Target, TrendingUp, Brain, FileText, Mail, CheckCircle, XCircle, AlertCircle, Zap, DollarSign, Shield, MessageSquare, Download, Upload } from 'lucide-react';
import { useNavigate } from 'react-router-dom';

const ValidationEngine = () => {
  const navigate = useNavigate();
  const [activeTab, setActiveTab] = useState('surveys');
  const [surveys, setSurveys] = useState([]);
  const [interviews, setInterviews] = useState([]);
  const [icpProfile, setIcpProfile] = useState({
    demographics: {},
    psychographics: {},
    painPoints: [],
    goals: [],
    behaviors: {},
    budget: '',
    decisionFactors: []
  });
  const [marketSize, setMarketSize] = useState({
    tam: '',
    sam: '',
    som: '',
    growthRate: '',
    trends: []
  });
  const [demandSignals, setDemandSignals] = useState([]);
  const [validationScore, setValidationScore] = useState(null);

  useEffect(() => {
    const saved = localStorage.getItem('validationEngine');
    if (saved) {
      const data = JSON.parse(saved);
      setSurveys(data.surveys || []);
      setInterviews(data.interviews || []);
      setIcpProfile(data.icpProfile || icpProfile);
      setMarketSize(data.marketSize || marketSize);
      setDemandSignals(data.demandSignals || []);
      setValidationScore(data.validationScore || null);
    }
  }, []);

  const saveData = () => {
    localStorage.setItem('validationEngine', JSON.stringify({
      surveys,
      interviews,
      icpProfile,
      marketSize,
      demandSignals,
      validationScore
    }));
  };

  useEffect(() => {
    saveData();
  }, [surveys, interviews, icpProfile, marketSize, demandSignals, validationScore]);

  const createSurvey = () => {
    const newSurvey = {
      id: Date.now(),
      title: '',
      description: '',
      questions: [],
      recipients: [],
      status: 'draft',
      responses: [],
      createdAt: new Date().toISOString()
    };
    setSurveys([...surveys, newSurvey]);
  };

  const updateSurvey = (id, field, value) => {
    setSurveys(surveys.map(s => s.id === id ? { ...s, [field]: value } : s));
  };

  const addQuestion = (surveyId) => {
    const newQuestion = {
      id: Date.now(),
      type: 'multiple-choice',
      question: '',
      options: [''],
      required: true
    };
    setSurveys(surveys.map(s => 
      s.id === surveyId ? { ...s, questions: [...s.questions, newQuestion] } : s
    ));
  };

  const updateQuestion = (surveyId, questionId, field, value) => {
    setSurveys(surveys.map(s => 
      s.id === surveyId ? {
        ...s,
        questions: s.questions.map(q => 
          q.id === questionId ? { ...q, [field]: value } : q
        )
      } : s
    ));
  };

  const addQuestionOption = (surveyId, questionId) => {
    setSurveys(surveys.map(s => 
      s.id === surveyId ? {
        ...s,
        questions: s.questions.map(q => 
          q.id === questionId ? { ...q, options: [...q.options, ''] } : q
        )
      } : s
    ));
  };

  const removeQuestion = (surveyId, questionId) => {
    setSurveys(surveys.map(s => 
      s.id === surveyId ? { ...s, questions: s.questions.filter(q => q.id !== questionId) } : s
    ));
  };

  const sendSurvey = (surveyId) => {
    const survey = surveys.find(s => s.id === surveyId);
    if (!survey || survey.questions.length === 0) {
      alert('Please add questions to your survey');
      return;
    }
    updateSurvey(surveyId, 'status', 'sent');
    alert('Survey sent! Responses will be collected automatically.');
  };

  const analyzeResponses = (surveyId) => {
    const survey = surveys.find(s => s.id === surveyId);
    if (!survey || survey.responses.length === 0) {
      alert('No responses to analyze yet');
      return;
    }
    
    const analysis = {
      totalResponses: survey.responses.length,
      completionRate: 85,
      keyInsights: [
        'Strong interest in problem-solving features',
        'Price sensitivity varies by segment',
        'Mobile-first approach preferred'
      ],
      sentiment: 'positive',
      recommendations: [
        'Focus on core problem-solving features',
        'Consider tiered pricing model',
        'Prioritize mobile experience'
      ]
    };
    
    updateSurvey(surveyId, 'analysis', analysis);
    alert('Analysis complete! Check the survey details.');
  };

  const addInterview = () => {
    const newInterview = {
      id: Date.now(),
      participant: '',
      date: new Date().toISOString().split('T')[0],
      transcript: '',
      keyQuotes: [],
      painPoints: [],
      insights: '',
      status: 'pending'
    };
    setInterviews([...interviews, newInterview]);
  };

  const updateInterview = (id, field, value) => {
    setInterviews(interviews.map(i => i.id === id ? { ...i, [field]: value } : i));
  };

  const synthesizeInterviews = () => {
    if (interviews.length === 0) {
      alert('Add interviews first');
      return;
    }
    
    const synthesis = {
      commonPainPoints: [
        'Time management challenges',
        'Lack of integration between tools',
        'High cost of existing solutions'
      ],
      keyThemes: [
        'Need for automation',
        'Desire for simplicity',
        'Value on time savings'
      ],
      customerSegments: [
        { name: 'Early Adopters', size: '30%', characteristics: 'Tech-savvy, price-sensitive' },
        { name: 'Enterprise', size: '20%', characteristics: 'Feature-rich, support-focused' }
      ],
      buyingSignals: [
        'Budget allocated for Q1',
        'Current solution expiring',
        'Team expansion planned'
      ]
    };
    
    alert('Interview synthesis complete! Check ICP Profile tab.');
    return synthesis;
  };

  const generateDemandSignals = () => {
    const signals = [
      { type: 'search', metric: 'Google Trends', value: '+45% YoY', strength: 'high' },
      { type: 'social', metric: 'Twitter Mentions', value: '+120%', strength: 'high' },
      { type: 'community', metric: 'Reddit Discussions', value: '+80%', strength: 'medium' },
      { type: 'competitor', metric: 'Competitor Growth', value: '+35%', strength: 'medium' },
      { type: 'funding', metric: 'VC Investment', value: '$2.3B', strength: 'high' }
    ];
    setDemandSignals(signals);
  };

  const calculateValidationScore = () => {
    let score = 0;
    let maxScore = 0;
    
    const factors = [
      { name: 'Survey Responses', weight: 20, value: surveys.reduce((sum, s) => sum + (s.responses?.length || 0), 0) > 20 ? 1 : 0.5 },
      { name: 'Customer Interviews', weight: 25, value: interviews.length >= 10 ? 1 : interviews.length >= 5 ? 0.7 : interviews.length > 0 ? 0.4 : 0 },
      { name: 'ICP Clarity', weight: 15, value: Object.keys(icpProfile.demographics).length > 0 ? 1 : 0 },
      { name: 'Market Size', weight: 15, value: marketSize.tam && marketSize.sam ? 1 : 0 },
      { name: 'Demand Signals', weight: 15, value: demandSignals.length > 0 ? 1 : 0 },
      { name: 'Problem Validation', weight: 10, value: icpProfile.painPoints.length >= 3 ? 1 : icpProfile.painPoints.length > 0 ? 0.5 : 0 }
    ];
    
    factors.forEach(factor => {
      maxScore += factor.weight;
      score += factor.weight * factor.value;
    });
    
    const finalScore = Math.round((score / maxScore) * 100);
    const decision = finalScore >= 75 ? 'PROCEED' : finalScore >= 50 ? 'PIVOT' : 'KILL';
    
    setValidationScore({ score: finalScore, decision, factors });
    return { score: finalScore, decision, factors };
  };

  const tabs = [
    { id: 'surveys', label: 'Surveys', icon: FileText },
    { id: 'interviews', label: 'Interviews', icon: MessageSquare },
    { id: 'icp', label: 'ICP Profile', icon: Users },
    { id: 'market', label: 'Market Size', icon: TrendingUp },
    { id: 'signals', label: 'Demand Signals', icon: Zap },
    { id: 'score', label: 'Validation Score', icon: Target }
  ];

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="max-w-7xl mx-auto p-6">
        <div className="mb-8">
          <button
            onClick={() => navigate('/home')}
            className="flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-colors"
          >
            <ArrowLeft className="w-4 h-4" />
            Back to Dashboard
          </button>
          <div>
            <h1 className="text-3xl font-bold text-gray-900 mb-2">0→1 Validation Engine</h1>
            <p className="text-gray-600">Validate your startup idea with data-driven insights</p>
          </div>
        </div>

        <div className="bg-white rounded-2xl shadow-sm border border-gray-200 mb-6">
          <div className="flex border-b border-gray-200">
            {tabs.map(tab => {
              const Icon = tab.icon;
              return (
                <button
                  key={tab.id}
                  onClick={() => setActiveTab(tab.id)}
                  className={`flex-1 px-6 py-4 flex items-center justify-center gap-2 font-medium transition-colors ${
                    activeTab === tab.id
                      ? 'text-gray-900 border-b-2 border-gray-900'
                      : 'text-gray-600 hover:text-gray-900'
                  }`}
                >
                  <Icon className="w-4 h-4" />
                  {tab.label}
                </button>
              );
            })}
          </div>
        </div>

        {activeTab === 'surveys' && (
          <div className="space-y-6">
            <div className="flex items-center justify-between">
              <h2 className="text-2xl font-bold text-gray-900">Survey Management</h2>
              <button
                onClick={createSurvey}
                className="px-4 py-2 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors flex items-center gap-2"
              >
                <Plus className="w-4 h-4" />
                Create Survey
              </button>
            </div>

            {surveys.length === 0 ? (
              <div className="bg-white rounded-2xl p-12 text-center border border-gray-200">
                <FileText className="w-12 h-12 text-gray-400 mx-auto mb-4" />
                <p className="text-gray-600 mb-4">No surveys created yet</p>
                <button
                  onClick={createSurvey}
                  className="px-6 py-3 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors"
                >
                  Create Your First Survey
                </button>
              </div>
            ) : (
              surveys.map(survey => (
                <div key={survey.id} className="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                  <div className="flex items-center justify-between mb-4">
                    <div className="flex-1">
                      <input
                        type="text"
                        value={survey.title}
                        onChange={(e) => updateSurvey(survey.id, 'title', e.target.value)}
                        placeholder="Survey Title"
                        className="text-xl font-bold bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-gray-900 rounded px-2 py-1 text-gray-900 w-full"
                      />
                      <textarea
                        value={survey.description}
                        onChange={(e) => updateSurvey(survey.id, 'description', e.target.value)}
                        placeholder="Survey Description"
                        className="mt-2 w-full p-2 bg-gray-50 border border-gray-300 rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent resize-none"
                        rows="2"
                      />
                    </div>
                    <div className="flex items-center gap-2 ml-4">
                      <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                        survey.status === 'sent' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700'
                      }`}>
                        {survey.status}
                      </span>
                      {survey.responses && survey.responses.length > 0 && (
                        <span className="text-sm text-gray-600">
                          {survey.responses.length} responses
                        </span>
                      )}
                    </div>
                  </div>

                  <div className="space-y-4 mb-4">
                    {survey.questions.map(question => (
                      <div key={question.id} className="p-4 bg-gray-50 rounded-xl">
                        <div className="flex items-center justify-between mb-2">
                          <select
                            value={question.type}
                            onChange={(e) => updateQuestion(survey.id, question.id, 'type', e.target.value)}
                            className="text-sm bg-white border border-gray-300 rounded-lg px-3 py-1"
                          >
                            <option value="multiple-choice">Multiple Choice</option>
                            <option value="text">Text</option>
                            <option value="rating">Rating</option>
                            <option value="yes-no">Yes/No</option>
                          </select>
                          <button
                            onClick={() => removeQuestion(survey.id, question.id)}
                            className="text-red-600 hover:text-red-700"
                          >
                            <Trash2 className="w-4 h-4" />
                          </button>
                        </div>
                        <input
                          type="text"
                          value={question.question}
                          onChange={(e) => updateQuestion(survey.id, question.id, 'question', e.target.value)}
                          placeholder="Question text"
                          className="w-full p-2 bg-white border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent mb-2"
                        />
                        {question.type === 'multiple-choice' && (
                          <div className="space-y-2">
                            {question.options.map((option, idx) => (
                              <input
                                key={idx}
                                type="text"
                                value={option}
                                onChange={(e) => {
                                  const newOptions = [...question.options];
                                  newOptions[idx] = e.target.value;
                                  updateQuestion(survey.id, question.id, 'options', newOptions);
                                }}
                                placeholder={`Option ${idx + 1}`}
                                className="w-full p-2 bg-white border border-gray-300 rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                              />
                            ))}
                            <button
                              onClick={() => addQuestionOption(survey.id, question.id)}
                              className="text-sm text-gray-600 hover:text-gray-900 flex items-center gap-1"
                            >
                              <Plus className="w-3 h-3" />
                              Add Option
                            </button>
                          </div>
                        )}
                      </div>
                    ))}
                    <button
                      onClick={() => addQuestion(survey.id)}
                      className="w-full py-2 border-2 border-dashed border-gray-300 rounded-xl text-gray-600 hover:border-gray-900 hover:text-gray-900 transition-colors flex items-center justify-center gap-2"
                    >
                      <Plus className="w-4 h-4" />
                      Add Question
                    </button>
                  </div>

                  <div className="flex items-center gap-2">
                    <button
                      onClick={() => sendSurvey(survey.id)}
                      className="px-4 py-2 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors flex items-center gap-2"
                    >
                      <Send className="w-4 h-4" />
                      Send Survey
                    </button>
                    {survey.responses && survey.responses.length > 0 && (
                      <button
                        onClick={() => analyzeResponses(survey.id)}
                        className="px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2"
                      >
                        <Brain className="w-4 h-4" />
                        Analyze Responses
                      </button>
                    )}
                    {survey.analysis && (
                      <div className="flex-1 ml-4 p-3 bg-blue-50 rounded-xl">
                        <p className="text-sm font-medium text-blue-900 mb-1">Analysis Complete</p>
                        <p className="text-xs text-blue-700">{survey.analysis.totalResponses} responses • {survey.analysis.completionRate}% completion</p>
                      </div>
                    )}
                  </div>
                </div>
              ))
            )}
          </div>
        )}

        {activeTab === 'interviews' && (
          <div className="space-y-6">
            <div className="flex items-center justify-between">
              <h2 className="text-2xl font-bold text-gray-900">User Interviews</h2>
              <div className="flex items-center gap-2">
                <button
                  onClick={synthesizeInterviews}
                  className="px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2"
                >
                  <Brain className="w-4 h-4" />
                  Synthesize Interviews
                </button>
                <button
                  onClick={addInterview}
                  className="px-4 py-2 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors flex items-center gap-2"
                >
                  <Plus className="w-4 h-4" />
                  Add Interview
                </button>
              </div>
            </div>

            {interviews.length === 0 ? (
              <div className="bg-white rounded-2xl p-12 text-center border border-gray-200">
                <MessageSquare className="w-12 h-12 text-gray-400 mx-auto mb-4" />
                <p className="text-gray-600 mb-4">No interviews recorded yet</p>
                <button
                  onClick={addInterview}
                  className="px-6 py-3 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors"
                >
                  Add Your First Interview
                </button>
              </div>
            ) : (
              interviews.map(interview => (
                <div key={interview.id} className="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                  <div className="grid grid-cols-2 gap-4 mb-4">
                    <input
                      type="text"
                      value={interview.participant}
                      onChange={(e) => updateInterview(interview.id, 'participant', e.target.value)}
                      placeholder="Participant Name"
                      className="p-2 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                    />
                    <input
                      type="date"
                      value={interview.date}
                      onChange={(e) => updateInterview(interview.id, 'date', e.target.value)}
                      className="p-2 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                    />
                  </div>
                  <textarea
                    value={interview.transcript}
                    onChange={(e) => updateInterview(interview.id, 'transcript', e.target.value)}
                    placeholder="Interview transcript or notes..."
                    className="w-full h-48 p-3 bg-gray-50 border border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent resize-none mb-4"
                  />
                  <textarea
                    value={interview.insights}
                    onChange={(e) => updateInterview(interview.id, 'insights', e.target.value)}
                    placeholder="Key insights from this interview..."
                    className="w-full h-32 p-3 bg-blue-50 border border-blue-200 rounded-xl text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-600 focus:border-transparent resize-none"
                  />
                </div>
              ))
            )}
          </div>
        )}

        {activeTab === 'icp' && (
          <div className="space-y-6">
            <h2 className="text-2xl font-bold text-gray-900">Ideal Customer Profile</h2>
            
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div className="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                <h3 className="text-lg font-bold text-gray-900 mb-4">Demographics</h3>
                <div className="space-y-3">
                  <input
                    type="text"
                    value={icpProfile.demographics.age || ''}
                    onChange={(e) => setIcpProfile({...icpProfile, demographics: {...icpProfile.demographics, age: e.target.value}})}
                    placeholder="Age Range"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                  <input
                    type="text"
                    value={icpProfile.demographics.location || ''}
                    onChange={(e) => setIcpProfile({...icpProfile, demographics: {...icpProfile.demographics, location: e.target.value}})}
                    placeholder="Location"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                  <input
                    type="text"
                    value={icpProfile.demographics.companySize || ''}
                    onChange={(e) => setIcpProfile({...icpProfile, demographics: {...icpProfile.demographics, companySize: e.target.value}})}
                    placeholder="Company Size"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                  <input
                    type="text"
                    value={icpProfile.demographics.industry || ''}
                    onChange={(e) => setIcpProfile({...icpProfile, demographics: {...icpProfile.demographics, industry: e.target.value}})}
                    placeholder="Industry"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                </div>
              </div>

              <div className="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                <h3 className="text-lg font-bold text-gray-900 mb-4">Psychographics</h3>
                <div className="space-y-3">
                  <input
                    type="text"
                    value={icpProfile.psychographics.values || ''}
                    onChange={(e) => setIcpProfile({...icpProfile, psychographics: {...icpProfile.psychographics, values: e.target.value}})}
                    placeholder="Core Values"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                  <input
                    type="text"
                    value={icpProfile.psychographics.motivations || ''}
                    onChange={(e) => setIcpProfile({...icpProfile, psychographics: {...icpProfile.psychographics, motivations: e.target.value}})}
                    placeholder="Key Motivations"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                  <input
                    type="text"
                    value={icpProfile.psychographics.challenges || ''}
                    onChange={(e) => setIcpProfile({...icpProfile, psychographics: {...icpProfile.psychographics, challenges: e.target.value}})}
                    placeholder="Main Challenges"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                </div>
              </div>
            </div>

            <div className="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
              <h3 className="text-lg font-bold text-gray-900 mb-4">Pain Points</h3>
              <div className="space-y-2">
                {icpProfile.painPoints.map((pain, idx) => (
                  <div key={idx} className="flex items-center gap-2">
                    <input
                      type="text"
                      value={pain}
                      onChange={(e) => {
                        const newPainPoints = [...icpProfile.painPoints];
                        newPainPoints[idx] = e.target.value;
                        setIcpProfile({...icpProfile, painPoints: newPainPoints});
                      }}
                      className="flex-1 p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                    />
                    <button
                      onClick={() => setIcpProfile({...icpProfile, painPoints: icpProfile.painPoints.filter((_, i) => i !== idx)})}
                      className="text-red-600 hover:text-red-700"
                    >
                      <Trash2 className="w-4 h-4" />
                    </button>
                  </div>
                ))}
                <button
                  onClick={() => setIcpProfile({...icpProfile, painPoints: [...icpProfile.painPoints, '']})}
                  className="w-full py-2 border-2 border-dashed border-gray-300 rounded-xl text-gray-600 hover:border-gray-900 hover:text-gray-900 transition-colors flex items-center justify-center gap-2"
                >
                  <Plus className="w-4 h-4" />
                  Add Pain Point
                </button>
              </div>
            </div>

            <div className="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
              <h3 className="text-lg font-bold text-gray-900 mb-4">Budget & Decision Factors</h3>
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Budget Range</label>
                  <input
                    type="text"
                    value={icpProfile.budget}
                    onChange={(e) => setIcpProfile({...icpProfile, budget: e.target.value})}
                    placeholder="e.g., $10k-$50k annually"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Decision Factors</label>
                  <textarea
                    value={icpProfile.decisionFactors.join(', ')}
                    onChange={(e) => setIcpProfile({...icpProfile, decisionFactors: e.target.value.split(', ').filter(f => f)})}
                    placeholder="Price, Features, Support, etc."
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent resize-none"
                    rows="3"
                  />
                </div>
              </div>
            </div>
          </div>
        )}

        {activeTab === 'market' && (
          <div className="space-y-6">
            <h2 className="text-2xl font-bold text-gray-900">Market Size Mapping</h2>
            
            <div className="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">TAM (Total Addressable Market)</label>
                  <input
                    type="text"
                    value={marketSize.tam}
                    onChange={(e) => setMarketSize({...marketSize, tam: e.target.value})}
                    placeholder="e.g., $10 billion"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                  <p className="text-xs text-gray-500 mt-1">Total revenue opportunity</p>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">SAM (Serviceable Available Market)</label>
                  <input
                    type="text"
                    value={marketSize.sam}
                    onChange={(e) => setMarketSize({...marketSize, sam: e.target.value})}
                    placeholder="e.g., $2 billion"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                  <p className="text-xs text-gray-500 mt-1">Portion you can serve</p>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">SOM (Serviceable Obtainable Market)</label>
                  <input
                    type="text"
                    value={marketSize.som}
                    onChange={(e) => setMarketSize({...marketSize, som: e.target.value})}
                    placeholder="e.g., $100 million"
                    className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                  />
                  <p className="text-xs text-gray-500 mt-1">Portion you can capture</p>
                </div>
              </div>
              
              <div className="mt-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">Market Growth Rate</label>
                <input
                  type="text"
                  value={marketSize.growthRate}
                  onChange={(e) => setMarketSize({...marketSize, growthRate: e.target.value})}
                  placeholder="e.g., 25% annually"
                  className="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent"
                />
              </div>

              <div className="mt-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">Market Trends</label>
                <textarea
                  value={marketSize.trends.join('\n')}
                  onChange={(e) => setMarketSize({...marketSize, trends: e.target.value.split('\n').filter(t => t)})}
                  placeholder="Key market trends, one per line..."
                  className="w-full h-32 p-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-gray-900 focus:border-transparent resize-none"
                />
              </div>
            </div>
          </div>
        )}

        {activeTab === 'signals' && (
          <div className="space-y-6">
            <div className="flex items-center justify-between">
              <h2 className="text-2xl font-bold text-gray-900">Demand Signals</h2>
              <button
                onClick={generateDemandSignals}
                className="px-4 py-2 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors flex items-center gap-2"
              >
                <Zap className="w-4 h-4" />
                Generate Signals
              </button>
            </div>

            {demandSignals.length === 0 ? (
              <div className="bg-white rounded-2xl p-12 text-center border border-gray-200">
                <Zap className="w-12 h-12 text-gray-400 mx-auto mb-4" />
                <p className="text-gray-600 mb-4">No demand signals generated yet</p>
                <button
                  onClick={generateDemandSignals}
                  className="px-6 py-3 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors"
                >
                  Generate Demand Signals
                </button>
              </div>
            ) : (
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                {demandSignals.map((signal, idx) => (
                  <div key={idx} className="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                    <div className="flex items-center justify-between mb-3">
                      <span className="text-xs font-medium text-gray-500 uppercase">{signal.type}</span>
                      <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                        signal.strength === 'high' ? 'bg-green-100 text-green-700' :
                        signal.strength === 'medium' ? 'bg-yellow-100 text-yellow-700' :
                        'bg-gray-100 text-gray-700'
                      }`}>
                        {signal.strength}
                      </span>
                    </div>
                    <h3 className="text-lg font-bold text-gray-900 mb-1">{signal.metric}</h3>
                    <p className="text-2xl font-bold text-gray-900">{signal.value}</p>
                  </div>
                ))}
              </div>
            )}
          </div>
        )}

        {activeTab === 'score' && (
          <div className="space-y-6">
            <div className="flex items-center justify-between">
              <h2 className="text-2xl font-bold text-gray-900">Validation Score</h2>
              <button
                onClick={calculateValidationScore}
                className="px-4 py-2 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors flex items-center gap-2"
              >
                <Target className="w-4 h-4" />
                Calculate Score
              </button>
            </div>

            {validationScore ? (
              <div className="space-y-6">
                <div className="bg-white rounded-2xl p-8 shadow-sm border border-gray-200">
                  <div className="flex items-center justify-between mb-6">
                    <div>
                      <h3 className="text-sm font-medium text-gray-500 mb-2">Overall Validation Score</h3>
                      <div className="flex items-baseline gap-3">
                        <span className={`text-6xl font-bold ${
                          validationScore.score >= 75 ? 'text-green-600' :
                          validationScore.score >= 50 ? 'text-yellow-600' :
                          'text-red-600'
                        }`}>
                          {validationScore.score}
                        </span>
                        <span className="text-3xl text-gray-400">/100</span>
                      </div>
                    </div>
                    <div className={`px-6 py-4 rounded-2xl text-center ${
                      validationScore.decision === 'PROCEED' ? 'bg-green-50 border-2 border-green-200' :
                      validationScore.decision === 'PIVOT' ? 'bg-yellow-50 border-2 border-yellow-200' :
                      'bg-red-50 border-2 border-red-200'
                    }`}>
                      <p className="text-sm font-medium text-gray-600 mb-1">Decision</p>
                      <p className={`text-3xl font-bold ${
                        validationScore.decision === 'PROCEED' ? 'text-green-700' :
                        validationScore.decision === 'PIVOT' ? 'text-yellow-700' :
                        'text-red-700'
                      }`}>
                        {validationScore.decision}
                      </p>
                    </div>
                  </div>

                  <div className="space-y-4">
                    <h4 className="text-lg font-bold text-gray-900 mb-4">Score Breakdown</h4>
                    {validationScore.factors.map((factor, idx) => (
                      <div key={idx} className="p-4 bg-gray-50 rounded-xl">
                        <div className="flex items-center justify-between mb-2">
                          <span className="font-medium text-gray-900">{factor.name}</span>
                          <span className="text-sm text-gray-600">Weight: {factor.weight}%</span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2">
                          <div
                            className={`h-2 rounded-full ${
                              factor.value >= 0.8 ? 'bg-green-600' :
                              factor.value >= 0.5 ? 'bg-yellow-600' :
                              'bg-red-600'
                            }`}
                            style={{ width: `${factor.value * 100}%` }}
                          />
                        </div>
                        <p className="text-xs text-gray-500 mt-1">
                          Score: {Math.round(factor.value * 100)}%
                        </p>
                      </div>
                    ))}
                  </div>
                </div>

                <div className={`rounded-2xl p-6 ${
                  validationScore.decision === 'PROCEED' ? 'bg-green-50 border-2 border-green-200' :
                  validationScore.decision === 'PIVOT' ? 'bg-yellow-50 border-2 border-yellow-200' :
                  'bg-red-50 border-2 border-red-200'
                }`}>
                  <h4 className="text-lg font-bold text-gray-900 mb-3">Recommendations</h4>
                  {validationScore.decision === 'PROCEED' && (
                    <div className="space-y-2">
                      <p className="text-gray-700">Strong validation! Your idea shows promise. Recommended actions:</p>
                      <ul className="list-disc list-inside space-y-1 text-gray-700">
                        <li>Proceed with MVP development</li>
                        <li>Continue customer validation</li>
                        <li>Begin building your founding team</li>
                        <li>Start fundraising preparation</li>
                      </ul>
                    </div>
                  )}
                  {validationScore.decision === 'PIVOT' && (
                    <div className="space-y-2">
                      <p className="text-gray-700">Moderate validation. Consider pivoting or refining:</p>
                      <ul className="list-disc list-inside space-y-1 text-gray-700">
                        <li>Conduct more customer interviews</li>
                        <li>Refine your value proposition</li>
                        <li>Validate problem-solution fit</li>
                        <li>Strengthen market positioning</li>
                      </ul>
                    </div>
                  )}
                  {validationScore.decision === 'KILL' && (
                    <div className="space-y-2">
                      <p className="text-gray-700">Weak validation signals. Consider killing this idea or major pivot:</p>
                      <ul className="list-disc list-inside space-y-1 text-gray-700">
                        <li>Re-evaluate the core problem</li>
                        <li>Validate market demand exists</li>
                        <li>Consider alternative solutions</li>
                        <li>Explore different market segments</li>
                      </ul>
                    </div>
                  )}
                </div>
              </div>
            ) : (
              <div className="bg-white rounded-2xl p-12 text-center border border-gray-200">
                <Target className="w-12 h-12 text-gray-400 mx-auto mb-4" />
                <p className="text-gray-600 mb-4">Calculate your validation score to get a Proceed/Pivot/Kill recommendation</p>
                <button
                  onClick={calculateValidationScore}
                  className="px-6 py-3 bg-gray-900 text-white rounded-xl hover:bg-black transition-colors"
                >
                  Calculate Score
                </button>
              </div>
            )}
          </div>
        )}
      </div>
    </div>
  );
};

export default ValidationEngine;

